## core

## 逻辑说明

1. 未进入电梯乘客只关心电梯到达楼层、电梯运动方向和是否满员
2. 进入电梯乘客只关心楼层
3. 调度器关心任务是否执行完毕并指派电梯去完成
4. 电梯关心电梯是否需要运动

### 订阅关系

1. 调度器订阅乘客，当乘客发布需求，其计算需求发布给电梯
2. 电梯订阅调度器，当调度器发布需求，在step后修改，发布给乘客
3. 乘客订阅电梯，发布需求给调度器，调度器发布需求给电梯，电梯运动至乘客处，乘客进入继续发布事件给调度器，调度器修改数据

### 数据

1. 调度器知道所有电梯信息和乘客信息，当有乘客按下电梯或者上下电梯会计算任务，当有电梯空闲才会发布消息
2. 电梯知道运动方向、楼层、是否满员
3. 乘客知道自己在哪一楼，去往哪一楼

## 如何传播

1. 乘客是单播的，只需要告知订阅器 type id [cur target eid] (呼叫需要cur target 进入需要target eid， 出去需要 eid)
2. 调度器是单播的，只需要告知电梯 id cur direction canEnter
3. 电梯是多播的，需要告知乘客 id cur canEnter direction

> 呼叫时指派电梯，进入时可能更新最远距离，出去时如果target为-1更新最远距离，target为 -1时更新最远距离可能更改方向
